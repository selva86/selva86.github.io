<!DOCTYPE html>
<html>
  <head>
    <title>Probit Regression - r-statistics.co</title>
    <meta charset="utf-8">
    <meta name="Description" content="R Language Tutorials for Advanced Statistics">
    <meta name="Keywords" content="R, Tutorial, Machine learning, Statistics, Data Mining, Analytics, Data science, Linear Regression, Logistic Regression, Time series, Forecasting">
    <meta name="Distribution" content="Global">
    <meta name="Author" content="Selva Prabhakaran">
    <meta name="Robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/screenshots/iconb-64.png" type="image/x-icon" />
    <link href="www/bootstrap.min.css" rel="stylesheet">
    <link href="www/highlight.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700'
      rel='stylesheet' type='text/css'>
    <!-- Color Script -->
    <style type="text/css">
      a {
       color: #3675C5;
       color: rgb(25, 145, 248);
       color: #4582ec;
       color: #3F73D8;
      }
      li {
        line-height: 1.65;
      }
      /* reduce spacing around math formula*/
      .MathJax_Display {
        margin: 0em 0em;
      }   
    </style>
    <!-- Add Google search -->
    <script language="Javascript" type="text/javascript">
  function my_search_google()
  {
    var query = document.getElementById("my-google-search").value;
    window.open("http://google.com/search?q=" + query
	+ "%20site:" + "http://r-statistics.co");
  }
</script>
  </head>

  <body>

    <div class="container">

      <div class="masthead">
       <!--
        <ul class="nav nav-pills pull-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Table of contents<b class="caret"></b>
            </a>
            <ul class="dropdown-menu pull-right" role="menu">
              <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li><a href="ggplot2-Tutorial-With-R.html">ggplot2 Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>
<li><a href="Information-Value-With-R.html">InformationValue package</a></li>

            </ul>
          </li>
        </ul>
        -->

        <ul class="nav nav-pills pull-right">
          <div class="input-group">
            <form onsubmit="my_search_google()">
                <input type="text" class="form-control" id="my-google-search" placeholder="Search..">
            <form>
          </div><!-- /input-group -->
        </ul><!-- /.col-lg-6 -->

        <h3 class="muted"><a href="/">r-statistics.co</a></h3>
        <hr>
      </div>

      <div class="row">
        <div class="col-xs-12 col-sm-3" id="nav">
        <div class="well">
          <li>
            <ul class="list-unstyled">
                <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li><a href="ggplot2-Tutorial-With-R.html">ggplot2 Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>
<li><a href="Information-Value-With-R.html">InformationValue package</a></li>

            </ul>
          </li>
        </div>

        <div class="well">
          Stay up-to-date. <a href="https://docs.google.com/forms/d/1xkMYkLNFU9U39Dd8S_2JC0p8B5t6_Yq6zUQjanQQJpY/viewform">Subscribe!</a>
        </div>

        
        <h4>Contents</h4>
        

          <ul class="list-unstyled" id="toc"></ul>
        <!--
          <hr>
          <p><a href="/contribute.html">How to contribute</a></p>

          <p><a class="btn btn-primary" href="">Edit this page</a></p>
        -->  
        </div>

        <div id="content" class="col-xs-12 col-sm-8 pull-right">

          <h1>Probit Regression</h1>
<blockquote>
<p>Probit regression can used to solve binary classification problems, just like logistic regression.</p>
</blockquote>
<p>While logistic regression used a cumulative logistic function, probit regression uses a normal cumulative density function for the estimation model. Specifying a probit model is similar to logistic regression, i.e. using the <code>glm()</code> function but with <code>family</code> argument set to <code>binomial(link=&quot;probit&quot;)</code>.</p>
<h2>Example Problem</h2>
<p>Lets use the same example from <a href="Logistic-Regression-With-R.html">logistic regression</a> and try to predict if an individual will earn more than $50K. So before running the code below that builds the probit model, you will have to follow the steps from <a href="http://r-statistics.co/Logistic-Regression-With-R.html#Create%20Training%20and%20Test%20Samples">logistic regression</a> to import and prepare the training and test data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">probitMod &lt;-<span class="st"> </span><span class="kw">glm</span>(ABOVE50K ~<span class="st"> </span>RELATIONSHIP +<span class="st"> </span>AGE +<span class="st"> </span>CAPITALGAIN +<span class="st"> </span>OCCUPATION +<span class="st"> </span>EDUCATIONNUM, <span class="dt">data=</span>trainingData, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;probit&quot;</span>))  <span class="co"># build the logit model</span>
predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(probitMod, testData, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)  <span class="co"># predict the probability scores</span>
<span class="kw">summary</span>(probitMod)  <span class="co"># model summary</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = ABOVE50K ~ RELATIONSHIP + AGE + CAPITALGAIN + OCCUPATION + </span>
<span class="co">#&gt;     EDUCATIONNUM, family = binomial(link = &quot;probit&quot;), data = trainingData)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -4.5104  -0.5506  -0.0005   0.6515   3.6745  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)                  -2.590e+00  1.401e-01 -18.492  &lt; 2e-16 ***</span>
<span class="co">#&gt; RELATIONSHIP Not-in-family   -1.330e+00  4.039e-02 -32.929  &lt; 2e-16 ***</span>
<span class="co">#&gt; RELATIONSHIP Other-relative  -1.565e+00  1.406e-01 -11.135  &lt; 2e-16 ***</span>
<span class="co">#&gt; RELATIONSHIP Own-child       -1.986e+00  8.785e-02 -22.611  &lt; 2e-16 ***</span>
<span class="co">#&gt; RELATIONSHIP Unmarried       -1.466e+00  6.308e-02 -23.241  &lt; 2e-16 ***</span>
<span class="co">#&gt; RELATIONSHIP Wife             1.758e-01  6.387e-02   2.753 0.005910 ** </span>
<span class="co">#&gt; AGE                           1.523e-02  1.358e-03  11.214  &lt; 2e-16 ***</span>
<span class="co">#&gt; CAPITALGAIN                   1.744e-04  9.158e-06  19.045  &lt; 2e-16 ***</span>
<span class="co">#&gt; OCCUPATION Adm-clerical       4.955e-01  9.583e-02   5.170 2.34e-07 ***</span>
<span class="co">#&gt; OCCUPATION Armed-Forces       7.364e-01  1.034e+00   0.712 0.476343    </span>
<span class="co">#&gt; OCCUPATION Craft-repair       7.247e-01  9.246e-02   7.838 4.59e-15 ***</span>
<span class="co">#&gt; OCCUPATION Exec-managerial    1.141e+00  9.117e-02  12.520  &lt; 2e-16 ***</span>
<span class="co">#&gt; OCCUPATION Farming-fishing    7.620e-02  1.237e-01   0.616 0.537808    </span>
<span class="co">#&gt; OCCUPATION Handlers-cleaners  3.048e-01  1.295e-01   2.353 0.018599 *  </span>
<span class="co">#&gt; OCCUPATION Machine-op-inspct  4.044e-01  1.060e-01   3.816 0.000136 ***</span>
<span class="co">#&gt; OCCUPATION Other-service      8.727e-02  1.098e-01   0.795 0.426548    </span>
<span class="co">#&gt; OCCUPATION Priv-house-serv   -1.605e+00  1.245e+00  -1.289 0.197400    </span>
<span class="co">#&gt; OCCUPATION Prof-specialty     9.801e-01  9.354e-02  10.477  &lt; 2e-16 ***</span>
<span class="co">#&gt; OCCUPATION Protective-serv    8.934e-01  1.271e-01   7.031 2.06e-12 ***</span>
<span class="co">#&gt; OCCUPATION Sales              8.024e-01  9.325e-02   8.605  &lt; 2e-16 ***</span>
<span class="co">#&gt; OCCUPATION Tech-support       9.705e-01  1.157e-01   8.387  &lt; 2e-16 ***</span>
<span class="co">#&gt; OCCUPATION Transport-moving   6.133e-01  1.054e-01   5.821 5.86e-09 ***</span>
<span class="co">#&gt; EDUCATIONNUM                  1.575e-01  7.696e-03  20.464  &lt; 2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 15216.0  on 10975  degrees of freedom</span>
<span class="co">#&gt; Residual deviance:  8753.6  on 10953  degrees of freedom</span>
<span class="co">#&gt; AIC: 8799.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 8</span></code></pre></div>
<p>Almost all the <span class="math inline"><em>X</em><em>s</em></span> have p values less than 0.05. So the significance of predictors should be of any concern here. It is okay to ignore few category levels of <code>OCCUPATION</code> not being significant, as most of the other levels have acceptable p values.</p>
<h2>Model Diagnostics</h2>
<p>The model diagnostics for probit models are the same as seen in case of <a href="http://r-statistics.co/Logistic-Regression-With-R.html#Model%20Diagnostics">logistic regression</a>.</p>
<h4>Determine Optimal Cutoff</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(InformationValue)
optCutOff &lt;-<span class="st"> </span><span class="kw">optimalCutoff</span>(testData$ABOVE50K, predicted_scores)[<span class="dv">1</span>] 
<span class="co">#=&gt; [1] 0.88</span></code></pre></div>
<h4>ROC Curve</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotROC</span>(testData$ABOVE50K, predicted_scores)</code></pre></div>
<p><img src='screenshots/ROC-Curve-Probit.png' width=609 height=513 /></p>
<p>The area under ROC curve is slightly higher than that of the logit model’s. Therefore this could be the preferred model.</p>
<h4>Concordance</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Concordance</span>(testData$ABOVE50K, predicted)
<span class="co">#&gt; $Concordance</span>
<span class="co">#&gt; [1] 0.891276</span></code></pre></div>
<p>Concordance is numerially similar to that of the logit model’s.</p>
<h4>Misclassification Error</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">misClassError</span>(testData$ABOVE50K, predicted_scores, <span class="dt">threshold =</span> optCutOff)
<span class="co">#=&gt; 0.0894</span></code></pre></div>
<p>The misclassification error is marginally higher than that of <a href="http://r-statistics.co/Logistic-Regression-With-R.html#Model%20Diagnostics">logit model</a>.</p>
<h4>Specificity and Sensitivity</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sensitivity</span>(testData$ABOVE50K, predicted_scores, <span class="dt">threshold =</span> optCutOff)
<span class="co">#&gt; 0.359541</span>
<span class="kw">specificity</span>(testData$ABOVE50K, predicted_scores, <span class="dt">threshold =</span> optCutOff)
<span class="co">#&gt; 0.9780574</span></code></pre></div>
<p>The ability to detect the events (i.e. persons earning more than $50K), is 5% higher than that of logit model with same formula. But the specificity that is pretty high is marginally lower compared to logit.</p>
<h4>Confusion Matrix</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confusionMatrix</span>(testData$ABOVE50K, predicted_scores, <span class="dt">threshold =</span> optCutOff)
<span class="co"># The columns are actuals, while rows are predicteds.</span>
<span class="co">#&gt;       0    1</span>
<span class="co">#&gt; 0 18810 1507</span>
<span class="co">#&gt; 1   422  846</span></code></pre></div>


        </div>
      </div>

      <div class="footer">
        <hr>
        <p>&copy; 2015 Selva Prabhakaran. Powered by <a href="http://jekyllrb.com/">jekyll</a>,
          <a href="http://yihui.name/knitr/">knitr</a>, and
          <a href="http://johnmacfarlane.net/pandoc/">pandoc</a>.
          This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons License.</a>
        </p>
      </div>

    </div> <!-- /container -->

  <script src="//code.jquery.com/jquery.js"></script>
  <script src="www/bootstrap.min.js"></script>
  <script src="www/toc.js"></script>
  <!-- MathJax Script -->
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
  </script>
  <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
  <!-- Google Analytics Code -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69351797-1', 'auto');
    ga('send', 'pageview');
  </script>

  <style type="text/css">
  /* reduce spacing around math formula*/
    .MathJax_Display {
      margin: 0em 0em;
    }
  </style>
  </body>
</html>